import{r as f,j as O,T as I,c as n,a as S,u as d,Z,w as U,b as e,d as u,o as a,F as g,i as h,t as o,g as x,k as $,e as q,l as G,m as J,f as p,p as w,v as E,N as H}from"./app-DicuFCha.js";import{_ as K}from"./AdminLayout-DZ2rE5hL.js";const P={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},Q={class:"flex items-center gap-3"},W={class:"relative"},X=["href"],Y={class:"bg-white border border-slate-200 rounded-2xl overflow-hidden shadow-sm"},ee={class:"overflow-x-auto"},te={class:"w-full text-left border-collapse"},se={class:"divide-y divide-slate-100"},le=["onClick"],oe={class:"px-6 py-5"},ae={class:"flex items-center gap-3"},ne={class:"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-semibold border border-slate-200"},re={class:"font-medium text-slate-900"},ie={class:"text-xs text-slate-500"},de={key:0,class:"mr-1"},ue={class:"px-6 py-5"},xe={class:"text-sm font-medium text-slate-900 capitalize"},ce={class:"text-xs text-slate-500 mt-0.5 line-clamp-1 max-w-[200px]"},me={class:"px-6 py-5"},be={class:"text-sm text-slate-600"},ve={class:"text-[10px] text-slate-400 mt-1"},pe={key:0,class:"mt-2 flex items-center gap-1.5"},ge={class:"text-[10px] text-slate-500"},fe={class:"px-6 py-5"},he={class:"px-6 py-5 text-right"},we=["onClick"],_e={key:0},ye={key:0,class:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex items-center justify-between"},ke={class:"text-sm text-slate-500"},Ce={class:"font-medium text-slate-700"},je={class:"font-medium text-slate-700"},Me={class:"font-medium text-slate-700"},Ve={class:"flex items-center gap-1"},Le={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto"},Ne={class:"relative bg-white rounded-2xl w-full max-w-2xl shadow-2xl transform transition-all my-8 border border-slate-200 flex flex-col max-h-[90vh]"},Te={class:"p-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50 flex-shrink-0"},ze={class:"text-xl font-bold text-slate-900"},Be={class:"text-sm text-slate-500 mt-1 flex flex-col"},Se={key:0},Ue=["href"],$e={class:"p-6 overflow-y-auto"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},He={class:"bg-slate-50 rounded-xl p-4 border border-slate-100"},Re={class:"space-y-3"},Ae={class:"font-medium text-slate-900"},De={class:"font-medium text-slate-900"},Fe={class:"font-medium text-slate-900"},Oe={class:"bg-slate-50 rounded-xl p-4 border border-slate-100"},Ie={class:"space-y-3"},Ze={class:"font-medium text-slate-900 break-words whitespace-pre-wrap"},qe={key:0},Ge={class:"font-medium text-slate-900 break-all text-sm"},Je={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ke={class:"space-y-5"},Pe={key:0},Qe=["value"],We={class:"p-6 bg-slate-50/80 flex justify-end gap-3 border-t border-slate-100 flex-shrink-0"},Xe=["disabled"],Ye={key:0,class:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},st={__name:"Index",props:{leads:Object,filters:Object,userRole:[String,Number],managers:Array},setup(i){let _;const y=i,k={new:{label:"–ù–æ–≤–∞—è",class:"bg-blue-50 text-blue-700 border-blue-100"},in_progress:{label:"–í —Ä–∞–±–æ—Ç–µ",class:"bg-amber-50 text-amber-700 border-amber-100"},rejected:{label:"–û—Ç–∫–∞–∑",class:"bg-rose-50 text-rose-700 border-rose-100"},completed:{label:"–ó–∞–≤–µ—Ä—à–µ–Ω–∞",class:"bg-emerald-50 text-emerald-700 border-emerald-100"}},c=f(y.filters.search||""),m=f(y.filters.status||""),R=()=>{clearTimeout(_),_=setTimeout(()=>{H.get(route("admin.leads.index"),{search:c.value,status:m.value},{preserveState:!0,replace:!0})},300)};O([c,m],()=>{R()});const l=f(null),r=I({status:"",manager_notes:"",manager_id:""}),C=b=>{l.value=b,r.status=b.status,r.manager_notes=b.manager_notes||"",r.manager_id=b.manager_id||""},A=()=>{r.put(route("admin.leads.update",l.value.id),{onSuccess:()=>{l.value=null}})},D=()=>{confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –í–°–ï –∑–∞—è–≤–∫–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!")&&H.delete(route("admin.leads.destroy-all"),{onSuccess:()=>{alert("–í—Å–µ –∑–∞—è–≤–∫–∏ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã")}})};return(b,t)=>(a(),n(g,null,[S(d(Z),{title:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏"}),S(K,null,{header:U(()=>[e("div",P,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900"},"–ó–∞—è–≤–∫–∏"),e("p",{class:"text-sm text-slate-500 mt-1"},"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –∏–∑ Telegram –±–æ—Ç–∞")],-1)),e("div",Q,[e("div",W,[t[8]||(t[8]=e("span",{class:"absolute inset-y-0 left-0 pl-3 flex items-center text-slate-400"},[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=v=>c.value=v),type:"text",placeholder:"–ü–æ–∏—Å–∫...",class:"pl-10 pr-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-full md:w-64 transition-all duration-200"},null,512),[[E,c.value]])]),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=v=>m.value=v),class:"border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"},[...t[9]||(t[9]=[e("option",{value:""},"–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã",-1),e("option",{value:"new"},"–ù–æ–≤—ã–µ",-1),e("option",{value:"in_progress"},"–í —Ä–∞–±–æ—Ç–µ",-1),e("option",{value:"rejected"},"–û—Ç–∫–∞–∑",-1),e("option",{value:"completed"},"–ó–∞–≤–µ—Ä—à–µ–Ω—ã",-1)])],512),[[w,m.value]]),e("a",{href:b.route("admin.leads.export",{search:c.value,status:m.value}),class:"px-4 py-2 text-sm font-semibold text-indigo-600 hover:bg-indigo-50 rounded-xl border border-indigo-200 transition-all duration-200 flex items-center gap-2",title:"–°–∫–∞—á–∞—Ç—å Excel"}," üìä Excel ",8,X),Number(i.userRole)===1?(a(),n("button",{key:0,onClick:D,class:"px-4 py-2 text-sm font-semibold text-rose-600 hover:bg-rose-50 rounded-xl border border-rose-200 transition-all duration-200",title:"–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞—è–≤–∫–∏"}," üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë ")):u("",!0)])])]),default:U(()=>{var v,j,M;return[e("div",Y,[e("div",ee,[e("table",te,[t[14]||(t[14]=e("thead",null,[e("tr",{class:"bg-slate-50 border-b border-slate-200"},[e("th",{class:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"–ö–ª–∏–µ–Ω—Ç"),e("th",{class:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"–£—Å–ª—É–≥–∞ / –û–±—ä–µ–º"),e("th",{class:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"–ö–æ–Ω—Ç–∞–∫—Ç—ã"),e("th",{class:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"–°—Ç–∞—Ç—É—Å"),e("th",{class:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right"},"–î–µ–π—Å—Ç–≤–∏–µ")])],-1)),e("tbody",se,[(a(!0),n(g,null,h(i.leads.data,s=>{var V,L,N,T,z,B;return a(),n("tr",{key:s.id,onClick:F=>C(s),class:"hover:bg-slate-50 transition-colors duration-150 group cursor-pointer"},[e("td",oe,[e("div",ae,[e("div",ne,o((V=s.user)!=null&&V.name?s.user.name.charAt(0):"?"),1),e("div",null,[e("div",re,o(s.client_name||((L=s.user)==null?void 0:L.name)||"–ù/–î"),1),e("div",ie,[s.client_name&&((N=s.user)!=null&&N.name)&&s.client_name!==s.user.name?(a(),n("span",de," ("+o(s.user.name)+") ",1)):u("",!0),x(" @"+o(((T=s.user)==null?void 0:T.username)||"no_username"),1)])])])]),e("td",ue,[e("div",xe,o(s.service_type),1),e("div",ce,o(s.volume_stage),1)]),e("td",me,[e("div",be,o(s.contacts),1),e("div",ve,o(new Date(s.created_at).toLocaleString("ru-RU")),1),s.manager?(a(),n("div",pe,[t[11]||(t[11]=e("div",{class:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-[8px] text-indigo-600 font-bold"},"M",-1)),e("span",ge,"–û—Ç–≤: "+o(s.manager.name),1)])):u("",!0)]),e("td",fe,[e("span",{class:$(["px-2.5 py-1 text-xs font-semibold rounded-lg border",((z=k[s.status])==null?void 0:z.class)||"bg-slate-100 text-slate-600 border-slate-200"])},o(((B=k[s.status])==null?void 0:B.label)||s.status),3)]),e("td",he,[e("button",{onClick:q(F=>C(s),["stop"]),class:"text-slate-400 hover:text-indigo-600 p-2 rounded-lg hover:bg-indigo-50 transition-all duration-200",title:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"},[...t[12]||(t[12]=[e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,we)])],8,le)}),128)),i.leads.data.length===0?(a(),n("tr",_e,[...t[13]||(t[13]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-slate-500 italic"}," –ó–∞—è–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã ",-1)])])):u("",!0)])])]),i.leads.links.length>3?(a(),n("div",ye,[e("div",ke,[t[15]||(t[15]=x(" –ü–æ–∫–∞–∑–∞–Ω–æ ",-1)),e("span",Ce,o(i.leads.from),1),t[16]||(t[16]=x(" - ",-1)),e("span",je,o(i.leads.to),1),t[17]||(t[17]=x(" –∏–∑ ",-1)),e("span",Me,o(i.leads.total),1)]),e("div",Ve,[(a(!0),n(g,null,h(i.leads.links,s=>(a(),G(d(J),{key:s.label,href:s.url||"#",data:{search:c.value,status:m.value},"preserve-state":!0,innerHTML:s.label,class:$(["px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200",[s.active?"bg-indigo-600 text-white shadow-sm":s.url?"text-slate-600 hover:bg-white hover:shadow-sm border border-transparent":"text-slate-300 pointer-events-none"]])},null,8,["href","data","innerHTML","class"]))),128))])])):u("",!0)]),l.value?(a(),n("div",Le,[e("div",{onClick:t[2]||(t[2]=s=>l.value=null),class:"fixed inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity"}),e("div",Ne,[e("div",Te,[e("div",null,[e("h2",ze,"–ó–∞—è–≤–∫–∞ #"+o(l.value.id),1),e("div",Be,[e("span",null,[t[18]||(t[18]=e("span",{class:"font-medium text-slate-700"},"–ö–ª–∏–µ–Ω—Ç:",-1)),x(" "+o(l.value.client_name||((v=l.value.user)==null?void 0:v.name)||"–ë–µ–∑ –∏–º–µ–Ω–∏")+" ",1),l.value.client_name&&((j=l.value.user)!=null&&j.name)&&l.value.client_name!==l.value.user.name?(a(),n("span",Se," ("+o(l.value.user.name)+") ",1)):u("",!0)]),(M=l.value.user)!=null&&M.username?(a(),n("a",{key:0,href:"https://t.me/"+l.value.user.username,target:"_blank",class:"text-indigo-600 hover:text-indigo-800 hover:underline w-fit"}," @"+o(l.value.user.username),9,Ue)):u("",!0)])]),e("button",{onClick:t[3]||(t[3]=s=>l.value=null),class:"text-slate-400 hover:text-slate-600 p-2 rounded-lg hover:bg-slate-100 transition-colors"},[...t[19]||(t[19]=[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",$e,[e("div",Ee,[e("div",He,[t[23]||(t[23]=e("h3",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3"},"–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞",-1)),e("div",Re,[e("div",null,[t[20]||(t[20]=e("div",{class:"text-xs text-slate-500 mb-0.5"},"–£—Å–ª—É–≥–∞",-1)),e("div",Ae,o(l.value.service_type),1)]),e("div",null,[t[21]||(t[21]=e("div",{class:"text-xs text-slate-500 mb-0.5"},"–û–±—ä–µ–º / –≠—Ç–∞–ø",-1)),e("div",De,o(l.value.volume_stage),1)]),e("div",null,[t[22]||(t[22]=e("div",{class:"text-xs text-slate-500 mb-0.5"},"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è",-1)),e("div",Fe,o(new Date(l.value.created_at).toLocaleString("ru-RU")),1)])])]),e("div",Oe,[t[26]||(t[26]=e("h3",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3"},"–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",-1)),e("div",Ie,[e("div",null,[t[24]||(t[24]=e("div",{class:"text-xs text-slate-500 mb-0.5"},"–ö–æ–Ω—Ç–∞–∫—Ç—ã –∏–∑ —Ñ–æ—Ä–º—ã",-1)),e("div",Ze,o(l.value.contacts),1)]),l.value.files?(a(),n("div",qe,[t[25]||(t[25]=e("div",{class:"text-xs text-slate-500 mb-0.5"},"–§–∞–π–ª—ã",-1)),e("div",Ge,o(l.value.files),1)])):u("",!0)])])]),t[32]||(t[32]=e("div",{class:"border-t border-slate-100 my-6"},null,-1)),t[33]||(t[33]=e("h3",{class:"text-lg font-bold text-slate-900 mb-4"},"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–æ–π",-1)),e("div",Je,[e("div",Ke,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-1.5"},"–°—Ç–∞—Ç—É—Å",-1)),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>d(r).status=s),class:"w-full border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 bg-white"},[...t[27]||(t[27]=[e("option",{value:"new"},"–ù–æ–≤–∞—è",-1),e("option",{value:"in_progress"},"–í —Ä–∞–±–æ—Ç–µ",-1),e("option",{value:"rejected"},"–û—Ç–∫–∞–∑",-1),e("option",{value:"completed"},"–ó–∞–≤–µ—Ä—à–µ–Ω–∞",-1)])],512),[[w,d(r).status]])]),Number(i.userRole)===1?(a(),n("div",Pe,[t[30]||(t[30]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-1.5"},"–ú–µ–Ω–µ–¥–∂–µ—Ä",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>d(r).manager_id=s),class:"w-full border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 bg-white"},[t[29]||(t[29]=e("option",{value:""},"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω",-1)),(a(!0),n(g,null,h(i.managers,s=>(a(),n("option",{key:s.id,value:s.id},o(s.name),9,Qe))),128))],512),[[w,d(r).manager_id]])])):u("",!0)]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-1.5 flex items-center justify-between"},[x(" –ó–∞–º–µ—Ç–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ "),e("span",{class:"text-[10px] text-slate-400 font-normal bg-slate-100 px-2 py-0.5 rounded-full"},"–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ")],-1)),p(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>d(r).manager_notes=s),rows:"5",placeholder:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º...",class:"w-full border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 resize-none"},null,512),[[E,d(r).manager_notes]])])])]),e("div",We,[e("button",{onClick:t[7]||(t[7]=s=>l.value=null),class:"px-5 py-2.5 text-sm font-semibold text-slate-700 hover:bg-white rounded-xl border border-slate-200 transition-all duration-200"}," –ó–∞–∫—Ä—ã—Ç—å "),e("button",{onClick:A,disabled:d(r).processing,class:"px-5 py-2.5 text-sm font-semibold text-white bg-indigo-600 hover:bg-indigo-700 rounded-xl shadow-lg shadow-indigo-100 disabled:opacity-50 transition-all duration-200 flex items-center gap-2"},[d(r).processing?(a(),n("svg",Ye,[...t[34]||(t[34]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):u("",!0),x(" "+o(d(r).processing?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è"),1)],8,Xe)])])])):u("",!0)]}),_:1})],64))}};export{st as default};
