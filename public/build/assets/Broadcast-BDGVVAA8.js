import{T as k,r as c,c as l,a as g,u as o,Z as y,w as p,b as e,d as a,t as n,o as r,e as _,f as C,v as M,g as m,F as j}from"./app-DicuFCha.js";import{_ as B}from"./AdminLayout-DZ2rE5hL.js";const L={class:"max-w-4xl"},N={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},V={class:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex items-center gap-4"},z={class:"text-2xl font-bold text-slate-900"},T={key:0,class:"bg-emerald-50 border border-emerald-100 p-6 rounded-2xl flex items-center gap-4 animate-in fade-in slide-in-from-top-4 duration-500"},P={class:"text-emerald-800 font-medium"},S={class:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden"},F={class:"mt-2 flex items-center justify-between text-xs text-slate-400"},G={key:0,class:"text-red-500 text-sm mt-1"},H={key:0,class:"relative inline-block"},U=["src"],A={key:1,class:"flex items-center justify-center w-full"},D={class:"flex flex-col items-center justify-center w-full h-32 border-2 border-slate-300 border-dashed rounded-2xl cursor-pointer bg-slate-50 hover:bg-slate-100 transition-colors"},E={key:2,class:"text-red-500 text-sm mt-1"},J={class:"bg-slate-50 p-4 rounded-xl border border-slate-100"},R={class:"flex items-start gap-3"},q={class:"text-sm text-slate-600"},I={class:"mt-0.5"},O={class:"flex justify-end"},Z=["disabled"],$={key:0,class:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},K={key:1,class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},X={__name:"Broadcast",props:{userCount:Number},setup(x){const t=k({message:"",image:null}),u=c(!1),b=c(""),i=c(null),f=d=>{const s=d.target.files[0];s&&(t.image=s,i.value=URL.createObjectURL(s))},v=()=>{t.image=null,i.value=null},h=()=>{t.post(route("admin.broadcast.send"),{onSuccess:d=>{var s;t.reset(),i.value=null,b.value=((s=d.props.flash)==null?void 0:s.success)||"Рассылка успешно завершена!",u.value=!0,setTimeout(()=>u.value=!1,5e3)}})};return(d,s)=>(r(),l(j,null,[g(o(y),{title:"Рассылка сообщений"}),g(B,null,{header:p(()=>[...s[1]||(s[1]=[e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900"},"Рассылка"),e("p",{class:"text-sm text-slate-500 mt-1"},"Отправка мгновенных сообщений всем пользователям бота")],-1)])]),default:p(()=>[e("div",L,[e("div",N,[e("div",V,[s[3]||(s[3]=e("div",{class:"w-12 h-12 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})])],-1)),e("div",null,[e("div",z,n(x.userCount),1),s[2]||(s[2]=e("div",{class:"text-sm text-slate-500"},"Активных пользователей",-1))])]),u.value?(r(),l("div",T,[s[4]||(s[4]=e("div",{class:"w-12 h-12 bg-emerald-100 text-emerald-600 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e("div",P,n(b.value),1)])):a("",!0)]),e("div",S,[s[16]||(s[16]=e("div",{class:"p-6 border-b border-slate-100"},[e("h2",{class:"text-lg font-bold text-slate-900"},"Новое сообщение")],-1)),e("form",{onSubmit:_(h,["prevent"]),class:"p-6 space-y-6"},[e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-2"},"Текст сообщения",-1)),C(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=w=>o(t).message=w),rows:"8",class:"w-full border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 p-4 text-slate-700 placeholder:text-slate-400",placeholder:"Введите текст акции, новости или важного уведомления...",required:""},null,512),[[M,o(t).message]]),e("div",F,[s[5]||(s[5]=e("span",null,"Поддерживается HTML разметка (<b>, <i>, <a>)",-1)),e("span",null,"Символов: "+n(o(t).message.length),1)]),o(t).errors.message?(r(),l("div",G,n(o(t).errors.message),1)):a("",!0)]),e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-2"},"Изображение (опционально)",-1)),i.value?(r(),l("div",H,[e("img",{src:i.value,class:"w-64 h-auto rounded-2xl border-2 border-slate-100 shadow-md"},null,8,U),e("button",{onClick:v,type:"button",class:"absolute -top-2 -right-2 bg-rose-500 text-white p-1.5 rounded-full hover:bg-rose-600 shadow-lg transition-colors"},[...s[7]||(s[7]=[e("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):(r(),l("div",A,[e("label",D,[s[8]||(s[8]=e("div",{class:"flex flex-col items-center justify-center pt-5 pb-6"},[e("svg",{class:"w-8 h-8 mb-4 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})]),e("p",{class:"mb-2 text-sm text-slate-500"},[e("span",{class:"font-bold"},"Нажмите, чтобы загрузить"),m(" или перетащите")]),e("p",{class:"text-xs text-slate-400"},"PNG, JPG или JPEG (МАКС. 10МБ)")],-1)),e("input",{onChange:f,type:"file",class:"hidden",accept:"image/*"},null,32)])])),o(t).errors.image?(r(),l("div",E,n(o(t).errors.image),1)):a("",!0)]),e("div",J,[e("div",R,[s[13]||(s[13]=e("svg",{class:"w-5 h-5 text-amber-500 shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",q,[s[12]||(s[12]=e("p",{class:"font-semibold text-slate-700"},"Внимание!",-1)),e("p",I,[s[10]||(s[10]=m("Сообщение будет отправлено всем ",-1)),e("b",null,n(x.userCount),1),s[11]||(s[11]=m(" пользователям. Это действие нельзя отменить. Рассылка займет некоторое время.",-1))])])])]),e("div",O,[e("button",{type:"submit",disabled:o(t).processing||!o(t).message,class:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-100 transition-all duration-200 active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed"},[o(t).processing?(r(),l("svg",$,[...s[14]||(s[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):a("",!0),e("span",null,n(o(t).processing?"Отправка...":"Запустить рассылку"),1),o(t).processing?a("",!0):(r(),l("svg",K,[...s[15]||(s[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"},null,-1)])]))],8,Z)])],32)])])]),_:1})],64))}};export{X as default};
